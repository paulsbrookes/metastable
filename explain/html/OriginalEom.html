<!DOCTYPE html>
<html>
<head>
    <title>OriginalEom</title>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']]
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.6;
        }
        pre {
            background-color: #f6f8fa;
            padding: 16px;
            border-radius: 6px;
            overflow: auto;
        }
        code {
            font-family: ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace;
        }
    </style>
</head>
<body>
    <h1>Derivation of the Equations of Motion</h1>

<p>In this document we explain how to derive the equations of motion from the Lagrangian</p>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mi>L</mi><mi>&</mi><mo>&#x0003D;</mo><msub><mover><mrow><mi>x</mi></mrow><mo>&#x002D9;</mo></mover><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x02212;</mo><msub><mover><mrow><mi>p</mi></mrow><mo>&#x002D9;</mo></mover><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x02212;</mo><mo stretchy="true" fence="true" minsize="2.470em" maxsize="2.470em">\{</mo><mi>&#x003B4;</mi><mo>&#x0002B;</mo><mfrac><mrow><mi>&#x003C7;</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo stretchy="true" fence="true" minsize="1.623em" maxsize="1.623em">(</mo><msubsup><mi>x</mi><mi>c</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mi>p</mi><mi>c</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo stretchy="true" fence="true" minsize="1.623em" maxsize="1.623em">)</mo><mo stretchy="true" fence="true" minsize="2.470em" maxsize="2.470em">\}</mo><mo stretchy="false">&#x00028;</mo><msub><mi>x</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x0002B;</mo><msub><mi>p</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo stretchy="false">&#x00029;</mo><mspace linebreak="newline" /><mi>&</mi><mspace width="1em" /><mo>&#x0002B;</mo><mi>&#x003BA;</mi><mo stretchy="false">&#x00028;</mo><msub><mi>x</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x02212;</mo><msub><mi>p</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mi>i</mi><mi>&#x003BA;</mi><mo stretchy="false">&#x00028;</mo><msubsup><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mn>2</mn><mi>&#x003B5;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mo>&#x0002E;</mo></mrow></mrow></math>

<h2>1. Recognizing the Canonical Structure</h2>

<p>Notice that the Lagrangian is <em>first order</em> in time derivatives, with the kinetic (or "symplectic") part given by</p>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><msub><mi>L</mi><mrow><mi mathvariant="normal">k</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></msub><mo>&#x0003D;</mo><msub><mover><mrow><mi>x</mi></mrow><mo>&#x002D9;</mo></mover><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x02212;</mo><msub><mover><mrow><mi>p</mi></mrow><mo>&#x002D9;</mo></mover><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mo>&#x0002E;</mo></mrow></math>

<p>This form identifies the canonical pairs as:
- <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>x</mi><mi>c</mi></msub></mrow></math> with conjugate momentum <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub></mrow></math>, and
- <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>p</mi><mi>c</mi></msub></mrow></math> with conjugate momentum <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mo>&#x02212;</mo><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub></mrow></math>.</p>

<p>Thus, the Lagrangian can be rewritten as</p>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mi>L</mi><mo>&#x0003D;</mo><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo>&#x002D9;</mo></mover><mi>c</mi></msub><mo>&#x02212;</mo><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo>&#x002D9;</mo></mover><mi>c</mi></msub><mo>&#x02212;</mo><mi>H</mi><mo stretchy="false">&#x00028;</mo><msub><mi>x</mi><mi>c</mi></msub><mo>&#x0002C;</mo><msub><mi>p</mi><mi>c</mi></msub><mo>&#x0002C;</mo><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x0002C;</mo><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo stretchy="false">&#x00029;</mo><mspace width="0.167em" /><mo>&#x0002C;</mo></mrow></math>

<p>where the "Hamiltonian" is given by</p>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><mi>H</mi><mo stretchy="false">&#x00028;</mo><msub><mi>x</mi><mi>c</mi></msub><mo>&#x0002C;</mo><msub><mi>p</mi><mi>c</mi></msub><mo>&#x0002C;</mo><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x0002C;</mo><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0003D;</mo><mi>&</mi><mspace width="0.278em" /><mo stretchy="true" fence="true" minsize="2.470em" maxsize="2.470em">[</mo><mi>&#x003B4;</mi><mo>&#x0002B;</mo><mfrac><mrow><mi>&#x003C7;</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo stretchy="true" fence="true" minsize="1.623em" maxsize="1.623em">(</mo><msubsup><mi>x</mi><mi>c</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mi>p</mi><mi>c</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo stretchy="true" fence="true" minsize="1.623em" maxsize="1.623em">)</mo><mo stretchy="true" fence="true" minsize="2.470em" maxsize="2.470em">]</mo><mo stretchy="false">&#x00028;</mo><msub><mi>x</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x0002B;</mo><msub><mi>p</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo stretchy="false">&#x00029;</mo><mspace linebreak="newline" /><mi>&</mi><mspace width="0.278em" /><mo>&#x02212;</mo><mi>&#x003BA;</mi><mo stretchy="false">&#x00028;</mo><msub><mi>x</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x02212;</mo><msub><mi>p</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo stretchy="false">&#x00029;</mo><mo>&#x02212;</mo><mi>i</mi><mi>&#x003BA;</mi><mo stretchy="false">&#x00028;</mo><msubsup><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo stretchy="false">&#x00029;</mo><mo>&#x02212;</mo><mn>2</mn><mi>&#x003B5;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mo>&#x0002E;</mo></mrow></mrow></math>

<h2>2. Writing Hamilton's Equations</h2>

<p>Since the kinetic term is in canonical form, the Eulerâ€“Lagrange equations for our variables are equivalent to Hamilton's equations. In particular, we have</p>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow><msub><mover><mrow><mi>x</mi></mrow><mo>&#x002D9;</mo></mover><mi>c</mi></msub><mi>&</mi><mo>&#x0003D;</mo><mfrac><mrow><mo>&#x02202;</mo><mi>H</mi></mrow><mrow><mo>&#x02202;</mo><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub></mrow></mfrac><mspace width="0.167em" /><mo>&#x0002C;</mo><mi>&</mi><mspace width="1em" /><msub><mover><mrow><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover></mrow><mo>&#x002D9;</mo></mover><mi>q</mi></msub><mi>&</mi><mo>&#x0003D;</mo><mo>&#x02212;</mo><mfrac><mrow><mo>&#x02202;</mo><mi>H</mi></mrow><mrow><mo>&#x02202;</mo><msub><mi>x</mi><mi>c</mi></msub></mrow></mfrac><mspace width="0.167em" /><mo>&#x0002C;</mo><mspace linebreak="newline" /><mo stretchy="false">[</mo><mn>1mm</mn><mo stretchy="false">]</mo><msub><mover><mrow><mi>p</mi></mrow><mo>&#x002D9;</mo></mover><mi>c</mi></msub><mi>&</mi><mo>&#x0003D;</mo><mo>&#x02212;</mo><mfrac><mrow><mo>&#x02202;</mo><mi>H</mi></mrow><mrow><mo>&#x02202;</mo><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub></mrow></mfrac><mspace width="0.167em" /><mo>&#x0002C;</mo><mi>&</mi><mspace width="1em" /><msub><mover><mrow><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover></mrow><mo>&#x002D9;</mo></mover><mi>q</mi></msub><mi>&</mi><mo>&#x0003D;</mo><mfrac><mrow><mo>&#x02202;</mo><mi>H</mi></mrow><mrow><mo>&#x02202;</mo><msub><mi>p</mi><mi>c</mi></msub></mrow></mfrac><mspace width="0.167em" /><mo>&#x0002E;</mo></mrow></mrow></math>

<h2>3. Computing the Partial Derivatives</h2>

<p>To compute these derivatives efficiently, one may introduce the shorthand</p>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mi>A</mi><mo>&#x02261;</mo><mi>&#x003B4;</mi><mo>&#x0002B;</mo><mfrac><mrow><mi>&#x003C7;</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo stretchy="true" fence="true" minsize="1.623em" maxsize="1.623em">(</mo><msubsup><mi>x</mi><mi>c</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mi>p</mi><mi>c</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo stretchy="true" fence="true" minsize="1.623em" maxsize="1.623em">)</mo><mspace width="1em" /><mtext>and</mtext><mspace width="1em" /><mi>B</mi><mo>&#x02261;</mo><msub><mi>x</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x0002B;</mo><msub><mi>p</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mo>&#x0002E;</mo></mrow></math>

<h3>Derivative with Respect to <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub></mrow></math>:</h3>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mfrac><mrow><mo>&#x02202;</mo><mi>H</mi></mrow><mrow><mo>&#x02202;</mo><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub></mrow></mfrac><mo>&#x0003D;</mo><mi>&#x003C7;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mi>B</mi><mo>&#x0002B;</mo><mi>A</mi><mspace width="0.167em" /><msub><mi>p</mi><mi>c</mi></msub><mo>&#x02212;</mo><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mi>x</mi><mi>c</mi></msub><mo>&#x02212;</mo><mn>2</mn><mi>i</mi><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x02212;</mo><mn>2</mn><mi>&#x003B5;</mi><mspace width="0.167em" /><mo>&#x0002E;</mo></mrow></math>

<p>Thus, the equation of motion for <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>x</mi><mi>c</mi></msub></mrow></math> is</p>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><msub><mover><mrow><mi>x</mi></mrow><mo>&#x002D9;</mo></mover><mi>c</mi></msub><mo>&#x0003D;</mo><mi>&#x003C7;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mi>B</mi><mo>&#x0002B;</mo><mi>A</mi><mspace width="0.167em" /><msub><mi>p</mi><mi>c</mi></msub><mo>&#x02212;</mo><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mi>x</mi><mi>c</mi></msub><mo>&#x02212;</mo><mn>2</mn><mi>i</mi><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x02212;</mo><mn>2</mn><mi>&#x003B5;</mi><mspace width="0.167em" /><mo>&#x0002E;</mo></mrow></math>

<h3>Derivative with Respect to <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>x</mi><mi>c</mi></msub></mrow></math>:</h3>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mfrac><mrow><mo>&#x02202;</mo><mi>H</mi></mrow><mrow><mo>&#x02202;</mo><msub><mi>x</mi><mi>c</mi></msub></mrow></mfrac><mo>&#x0003D;</mo><mi>&#x003C7;</mi><mspace width="0.167em" /><msub><mi>x</mi><mi>c</mi></msub><mspace width="0.167em" /><mi>B</mi><mo>&#x0002B;</mo><mi>A</mi><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x02212;</mo><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mo>&#x0002E;</mo></mrow></math>

<p>Thus, the equation of motion for <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub></mrow></math> is</p>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><msub><mover><mrow><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover></mrow><mo>&#x002D9;</mo></mover><mi>q</mi></msub><mo>&#x0003D;</mo><mo>&#x02212;</mo><mi>&#x003C7;</mi><mspace width="0.167em" /><msub><mi>x</mi><mi>c</mi></msub><mspace width="0.167em" /><mi>B</mi><mo>&#x02212;</mo><mi>A</mi><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x0002B;</mo><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mo>&#x0002E;</mo></mrow></math>

<h3>Derivative with Respect to <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub></mrow></math>:</h3>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mfrac><mrow><mo>&#x02202;</mo><mi>H</mi></mrow><mrow><mo>&#x02202;</mo><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub></mrow></mfrac><mo>&#x0003D;</mo><mi>&#x003C7;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mi>B</mi><mo>&#x0002B;</mo><mi>A</mi><mspace width="0.167em" /><msub><mi>x</mi><mi>c</mi></msub><mo>&#x0002B;</mo><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mi>p</mi><mi>c</mi></msub><mo>&#x02212;</mo><mn>2</mn><mi>i</mi><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mo>&#x0002E;</mo></mrow></math>

<p>Thus, the equation of motion for <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>p</mi><mi>c</mi></msub></mrow></math> is</p>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><msub><mover><mrow><mi>p</mi></mrow><mo>&#x002D9;</mo></mover><mi>c</mi></msub><mo>&#x0003D;</mo><mo>&#x02212;</mo><mi>&#x003C7;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mi>B</mi><mo>&#x02212;</mo><mi>A</mi><mspace width="0.167em" /><msub><mi>x</mi><mi>c</mi></msub><mo>&#x02212;</mo><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mi>p</mi><mi>c</mi></msub><mo>&#x0002B;</mo><mn>2</mn><mi>i</mi><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mo>&#x0002E;</mo></mrow></math>

<h3>Derivative with Respect to <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>p</mi><mi>c</mi></msub></mrow></math>:</h3>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mfrac><mrow><mo>&#x02202;</mo><mi>H</mi></mrow><mrow><mo>&#x02202;</mo><msub><mi>p</mi><mi>c</mi></msub></mrow></mfrac><mo>&#x0003D;</mo><mi>&#x003C7;</mi><mspace width="0.167em" /><msub><mi>p</mi><mi>c</mi></msub><mspace width="0.167em" /><mi>B</mi><mo>&#x0002B;</mo><mi>A</mi><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x0002B;</mo><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mo>&#x0002E;</mo></mrow></math>

<p>Thus, the equation of motion for <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub></mrow></math> is</p>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><msub><mover><mrow><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover></mrow><mo>&#x002D9;</mo></mover><mi>q</mi></msub><mo>&#x0003D;</mo><mi>&#x003C7;</mi><mspace width="0.167em" /><msub><mi>p</mi><mi>c</mi></msub><mspace width="0.167em" /><mi>B</mi><mo>&#x0002B;</mo><mi>A</mi><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x0002B;</mo><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mo>&#x0002E;</mo></mrow></math>

<h2>4. Final Set of Equations</h2>

<p>Summarizing, the equations of motion are</p>

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><menclose notation="box"><mrow><mrow><msub><mover><mrow><mi>x</mi></mrow><mo>&#x002D9;</mo></mover><mi>c</mi></msub><mi>&</mi><mo>&#x0003D;</mo><mi>&#x003C7;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mo stretchy="false">&#x00028;</mo><msub><mi>x</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x0002B;</mo><msub><mi>p</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>&#x003B4;</mi><mo>&#x0002B;</mo><mfrac><mrow><mi>&#x003C7;</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo stretchy="false">&#x00028;</mo><msubsup><mi>x</mi><mi>c</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mi>p</mi><mi>c</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><msub><mi>p</mi><mi>c</mi></msub><mo>&#x02212;</mo><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mi>x</mi><mi>c</mi></msub><mo>&#x02212;</mo><mn>2</mn><mi>i</mi><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x02212;</mo><mn>2</mn><mi>&#x003B5;</mi><mspace width="0.167em" /><mo>&#x0002C;</mo><mspace linebreak="newline" /><mo stretchy="false">[</mo><mn>1mm</mn><mo stretchy="false">]</mo><msub><mover><mrow><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover></mrow><mo>&#x002D9;</mo></mover><mi>q</mi></msub><mi>&</mi><mo>&#x0003D;</mo><mo>&#x02212;</mo><mi>&#x003C7;</mi><mspace width="0.167em" /><msub><mi>x</mi><mi>c</mi></msub><mspace width="0.167em" /><mo stretchy="false">&#x00028;</mo><msub><mi>x</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x0002B;</mo><msub><mi>p</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo stretchy="false">&#x00029;</mo><mo>&#x02212;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>&#x003B4;</mi><mo>&#x0002B;</mo><mfrac><mrow><mi>&#x003C7;</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo stretchy="false">&#x00028;</mo><msubsup><mi>x</mi><mi>c</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mi>p</mi><mi>c</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x0002B;</mo><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mo>&#x0002C;</mo><mspace linebreak="newline" /><mo stretchy="false">[</mo><mn>1mm</mn><mo stretchy="false">]</mo><msub><mover><mrow><mi>p</mi></mrow><mo>&#x002D9;</mo></mover><mi>c</mi></msub><mi>&</mi><mo>&#x0003D;</mo><mo>&#x02212;</mo><mi>&#x003C7;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mo stretchy="false">&#x00028;</mo><msub><mi>x</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x0002B;</mo><msub><mi>p</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo stretchy="false">&#x00029;</mo><mo>&#x02212;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>&#x003B4;</mi><mo>&#x0002B;</mo><mfrac><mrow><mi>&#x003C7;</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo stretchy="false">&#x00028;</mo><msubsup><mi>x</mi><mi>c</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mi>p</mi><mi>c</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><msub><mi>x</mi><mi>c</mi></msub><mo>&#x02212;</mo><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mi>p</mi><mi>c</mi></msub><mo>&#x0002B;</mo><mn>2</mn><mi>i</mi><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mo>&#x0002C;</mo><mspace linebreak="newline" /><mo stretchy="false">[</mo><mn>1mm</mn><mo stretchy="false">]</mo><msub><mover><mrow><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover></mrow><mo>&#x002D9;</mo></mover><mi>q</mi></msub><mi>&</mi><mo>&#x0003D;</mo><mi>&#x003C7;</mi><mspace width="0.167em" /><msub><mi>p</mi><mi>c</mi></msub><mspace width="0.167em" /><mo stretchy="false">&#x00028;</mo><msub><mi>x</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x0002B;</mo><msub><mi>p</mi><mi>c</mi></msub><mspace width="0.167em" /><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo stretchy="false">&#x00029;</mo><mo>&#x0002B;</mo><mrow><mo stretchy="true" fence="true" form="prefix">&#x00028;</mo><mi>&#x003B4;</mi><mo>&#x0002B;</mo><mfrac><mrow><mi>&#x003C7;</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mo stretchy="false">&#x00028;</mo><msubsup><mi>x</mi><mi>c</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mi>p</mi><mi>c</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo>&#x0002B;</mo><msubsup><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi><mn>2</mn></msubsup><mo stretchy="false">&#x00029;</mo><mo stretchy="true" fence="true" form="postfix">&#x00029;</mo></mrow><msub><mover><mrow><mi>p</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mo>&#x0002B;</mo><mi>&#x003BA;</mi><mspace width="0.167em" /><msub><mover><mrow><mi>x</mi></mrow><mo stretchy="false">&#x0007E;</mo></mover><mi>q</mi></msub><mspace width="0.167em" /><mo>&#x0002E;</mo></mrow></mrow></menclose></mrow></math>

</body>
</html>